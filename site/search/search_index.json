{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Pr\u00e1ctica 2.1 \u2013 Instalaci\u00f3n y configuraci\u00f3n de servidor web Nginx","text":""},{"location":"#instalacion-servidor-web-nginx","title":"Instalaci\u00f3n servidor web Nginx","text":"<p>Para instalar el servidor nginx en nuestra Debian, primero actualizamos los repositorios y despu\u00e9s instalamos el paquete correspondiente:</p> <p> </p> <p>Comprobamos que nginx se ha instalado y que est\u00e1 funcionando correctamente:</p> <p></p>"},{"location":"#creacion-de-las-carpeta-del-sitio-web","title":"Creaci\u00f3n de las carpeta del sitio web","text":"<p>Todos los archivos que forman parte de un sitio web que servir\u00e1 nginx se organizar\u00e1n en carpetas. Estas carpetas, t\u00edpicamente est\u00e1n dentro de <code>/var/www</code></p> <p>As\u00ed que, vamos a crear la carpeta de nuestro sitio web o dominio:</p> <p></p> <p>Dentro de esa carpeta html, deb\u00e9is clonar el siguiente repositorio</p> <p></p> <p>Adem\u00e1s, haremos que el propietario de esta carpeta y todo lo que haya dentro sea el usuario www-data, t\u00edpicamente el usuario del servicio web.</p> <p> Para comprobar que el servidor est\u00e1 funcionando y sirviendo p\u00e1ginas correctamente, pod\u00e9is acceder desde vuestro cliente a con la direcci\u00f3n IP de la m\u00e1quina virtual  </p>"},{"location":"#configuracion-de-servidor-web-nginx","title":"Configuraci\u00f3n de servidor web NGINX","text":"<p>En <code>/etc/nginx/sites-available/a23momuga.github.io</code> insertamos el siguiente contenido  Y crearemos un archivo simb\u00f3lico entre este archivo y el de sitios que est\u00e1n habilitados, para que se d\u00e9 de alta autom\u00e1ticamente. </p>"},{"location":"#comprobaciones","title":"Comprobaciones","text":"<p>Editamos el archivo <code>/etc/hosts</code> de nuestra m\u00e1quina anfitriona para que asocie la IP de la m\u00e1quina virtual, a nuestro <code>server_name</code>. </p> <p>Usando el siguiente comando podemos ver cada solicitud a su servidor web se registra en este archivo de registro </p>"},{"location":"#configurar-servidor-sftp-en-debian","title":"Configurar servidor SFTP en Debian","text":"<p>En primer lugar, lo instalaremos desde los repositorios:  Ahora vamos a crear una carpeta en nuestro home en Debian: </p> <p>Ahora vamos a crear los certificados de seguridad necesarios para aportar la capa de cifrado a nuestra conexi\u00f3n </p> <p>Y una vez realizados estos pasos, procedemos a realizar la configuraci\u00f3n de vsftpd propiamente dicha, buscaremos las siguientes l\u00edneas del archivo y las eliminaremos por completo</p> <p></p> <p>Tras ello, a\u00f1adiremos estas l\u00edneas en su lugar </p> <p>Y, tras guardar los cambios, reiniciamos el servicio para que coja la nueva configuraci\u00f3n: </p> <p>Y ya podremos usar ftp con el servidor nginx (Puerto 21 para ftp y Puerto 22 para sftp)</p> <p></p>"},{"location":"P2.2/","title":"Pr\u00e1ctica 2.2 \u2013 Autenticaci\u00f3n en Nginx","text":""},{"location":"P2.2/#paquetes-necesarios","title":"Paquetes necesarios","text":"<p>Comprobamos  si el paquete est\u00e1 instalado </p>"},{"location":"P2.2/#creacion-de-usuarios-y-contrasenas-para-el-acceso-web","title":"Creaci\u00f3n de usuarios y contrase\u00f1as para el acceso web","text":"<p>Crearemos un archivo oculto llamado \u201c.htpasswd\u201d en el directorio de configuraci\u00f3n /etc/nginx donde guardar nuestros usuarios y contrase\u00f1as </p> <p> Comprobamos que el usuario y la contrase\u00f1a aparecen cifrados en el fichero </p>"},{"location":"P2.2/#configurando-el-servidor-nginx-para-usar-autenticacion-basica","title":"Configurando el servidor Nginx para usar autenticaci\u00f3n b\u00e1sica","text":"<p>Utilizaremos la directiva <code>auth_basic</code> dentro del location y le pondremos el nombre a nuestro dominio que ser\u00e1 mostrado al usuario al solicitar las credenciales. Por \u00faltimo, configuramos Nginx para que utilice el fichero que previamente hemos creado con la directiva <code>auth_basic_user_file</code> </p>"},{"location":"P2.2/#probando-la-nueva-configuracion","title":"Probando la nueva configuraci\u00f3n","text":"<p>Comprobamos desde la m\u00e1quina f\u00edsica que podemos acceder al sitio web y que se te solicita autenticaci\u00f3n </p> <p></p> <p>En caso de fallar el usuario/contrase\u00f1a saldr\u00e1 el siguiente error:  </p> <p>Si queremos acceder a un nuevo location debajo con la autenticaci\u00f3n b\u00e1sica para el archivo/secci\u00f3n contact.html \u00fanicamente usamos a\u00f1adimos la siguiente configuraci\u00f3n:</p> <p></p> <p>Y podemos comprobar como pide la autenticaci\u00f3n:   </p>"},{"location":"P2.2/#combinacion-de-la-autenticacion-basica-con-la-restriccion-de-acceso-por-ip","title":"Combinaci\u00f3n de la autenticaci\u00f3n b\u00e1sica con la restricci\u00f3n de acceso por IP","text":"<p>C\u00f3mo permitir o bloquear el acceso a una IP espec\u00edfica (directivas <code>allow</code> y <code>deny</code>, respectivamente). Dentro del bloque del servidor o en el archivo de configuraci\u00f3n del dominio web, que, como recordatorio, est\u00e1 ubicado en el directorio sites-available:</p> <p><code>deny all</code> indica que, por defecto, se denegar\u00e1 el acceso a todos. Por ello, es crucial colocar las reglas m\u00e1s espec\u00edficas de allow y deny justo antes de esta, ya que se evaluar\u00e1n en el orden en que est\u00e1n. Si se colocaran despu\u00e9s, se bloquear\u00eda el acceso a todos, dado que deny all ser\u00eda evaluado primero.</p> <p><code>satisfy all</code> se utiliza para permitir el uso cambiando de una ip valida (con allow o deny) y ademas ser un usuario valido. si una de las dos validaciones no es correcta el usuario no puede acceder a la web.</p> <p><code>satisfy any</code> mientras el usuario o la ip sean validas el usuario podr\u00e1 acceder a la web</p> <p>En el ejemplo se deniega el acceso a la ip 192.16.0.20  </p>"},{"location":"P2.2/#cuestiones","title":"Cuestiones","text":""},{"location":"P2.2/#cuestion-1","title":"Cuesti\u00f3n 1","text":"<p>Supongamos que yo soy el cliente con la IP 172.1.10.15 e intento acceder al directorio web_muy_guay de mi sitio web, equivoc\u00e1ndome al poner el usuario y contrase\u00f1a. \u00bfPodr\u00e9 acceder?\u00bfPor qu\u00e9?</p> <p></p>"},{"location":"P2.2/#solucion","title":"Soluci\u00f3n","text":"<p>El usuario no podra acceder a la web. Tiene una IP permitida dentro de la configuracion, pero necesita tener tanto una IP valida como autentificarse correctamente. esto debido a la presencia de satisfy all;</p>"},{"location":"P2.2/#cuestion-2","title":"Cuesti\u00f3n 2","text":"<p>ask \"Cuesti\u00f3n 1\" Supongamos que yo soy el cliente con la IP 172.1.10.15 e intento acceder al directorio web_muy_guay de mi sitio web, introduciendo correctamente usuari y contrase\u00f1a. \u00bfPodr\u00e9 acceder?\u00bfPor qu\u00e9?</p> <p></p>"},{"location":"P2.2/#solucion_1","title":"Soluci\u00f3n","text":"<p>S\u00ed, se podr\u00e1 acceder a la web pues se utiliza una IP admitida y una autentificaci\u00f3n correcta.</p>"},{"location":"P2.2/#cuestion-3","title":"Cuesti\u00f3n 3","text":"<p>Supongamos que yo soy el cliente con la IP 172.1.10.15 e intento acceder al directorio web_muy_guay de mi sitio web, introduciendo correctamente usuario y contrase\u00f1a. \u00bfPodr\u00e9 acceder?\u00bfPor qu\u00e9?</p> <p></p>"},{"location":"P2.2/#solucion_2","title":"Soluci\u00f3n","text":"<p>Podr\u00e1 acceder. dado que la presencia de satisfy any indica que teniendo una ip valida o introduciendo unas credenciales correctas podemos acceder a la web</p>"},{"location":"P2.2/#cuestion-4","title":"Cuesti\u00f3n 4","text":"<p>A lo mejor no sab\u00e9is que tengo una web para documentar todas mis excursiones espaciales con Jeff, es esta: Jeff Bezos y yo. Supongamos que quiero restringir el acceso al directorio de proyectos porque es muy secreto, eso quiere decir a\u00f1adir autenticaci\u00f3n b\u00e1sica a la URL:Proyectos. Completa la configuraci\u00f3n para conseguirlo:</p> <p></p>"},{"location":"P2.2/#solucion_3","title":"Soluci\u00f3n","text":"<pre><code>server {\n    listen 80;\n    listen [::]:80;\n    root /var/www/freewebsitetemplates.com/preview/space-science;\n    index index.html index.htm index.nginx-debian.html;\n    server_name freewebsitetemplates.com www.freewebsitetemplates.com;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n\n    location /Proyectos/ {\n        auth_basic \"Restricted Area\";\n        auth_basic_user_file /etc/nginx/.htpasswd;\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre>"}]}